FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBzYXRlbGxpdGUtYXBiCmRlc2NyaXB0aW9uOiBQaHlzaWNh\
bCBTZXJ2ZXIgUmVxdWVzdApiaW5kYWJsZTogZmFsc2UKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRh\
OgogIGRpc3BsYXlOYW1lOiBQaHlzaWNhbCBTZXJ2ZXIgUmVxdWVzdAogIGltYWdlVXJsOiAiaHR0\
cHM6Ly9zMy5hbWF6b25hd3MuY29tL3N1bW1pdGRlbW9qaC8zNTEwNzc5Yi5qcGVnIgpwbGFuczoK\
LSBuYW1lOiBkZWZhdWx0CiAgZGVzY3JpcHRpb246IEN1c3RvbSBwbGFuIGZvciBwaHlzaWNhbCBz\
ZXJ2ZXIgcmVxdWVzdCBieSBjcHUsIG1lbW9yeSBhbmQgZGlzay4KICBmcmVlOiB0cnVlCiAgbWV0\
YWRhdGE6IHt9CiAgcGFyYW1ldGVyczoKICAtIHRpdGxlOiBTYXRlbGxpdGUgUmVxdWVzdGVyCiAg\
ICBuYW1lOiBzYXRlbGxpdGVfdXNlcgogICAgdHlwZTogc3RyaW5nCiAgICByZXF1aXJlZDogdHJ1\
ZQogICAgZGVmYXVsdDogJ2FkbWluJwogICAgZGlzcGxheV9ncm91cDogU2F0ZWxsaXRlIENyZWRl\
bnRpYWxzCiAgLSB0aXRsZTogU2F0ZWxsaXRlIFBhc3N3b3JkCiAgICBuYW1lOiBzYXRlbGxpdGVf\
cGFzc3dvcmQKICAgIHR5cGU6IHN0cmluZwogICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAg\
ZGVmYXVsdDogJ3Bhc3N3b3JkJwogICAgcmVxdWlyZWQ6IHRydWUKICAgIGRpc3BsYXlfZ3JvdXA6\
IFNhdGVsbGl0ZSBDcmVkZW50aWFscwogIC0gbmFtZTogbWluX2Rpc2tzX3NpemUKICAgIHRpdGxl\
OiBNaW5pbXVtIERpc2sgU2l6ZSAoTUIpCiAgICBkZWZhdWx0OiAxMDAwMAogICAgZGlzcGxheV9n\
cm91cDogUGh5c2ljYWwgUmVxdWlyZW1lbnRzCiAgICB0eXBlOiBpbnRlZ2VyCiAgICByZXF1aXJl\
ZDogZmFsc2UKICAtIG5hbWU6IG1pbl9tZW1vcnkKICAgIHRpdGxlOiBNaW5pbXVtIE1lbW9yeSAo\
TUIpCiAgICBkZWZhdWx0OiA1MDAKICAgIGRpc3BsYXlfZ3JvdXA6IFBoeXNpY2FsIFJlcXVpcmVt\
ZW50cwogICAgdHlwZTogaW50ZWdlcgogICAgcmVxdWlyZWQ6IGZhbHNlCiAgLSBuYW1lOiBtaW5f\
Y3B1CiAgICB0aXRsZTogIE51bWJlciBvZiBDUFVzCiAgICBkZWZhdWx0OiAnJwogICAgZGlzcGxh\
eV9ncm91cDogUGh5c2ljYWwgUmVxdWlyZW1lbnRzCiAgICB0eXBlOiBpbnRlZ2VyCiAgICByZXF1\
aXJlZDogdHJ1ZQogIC0gbmFtZTogc2VydmVyX25hbWUKICAgIHRpdGxlOiBTZXJ2ZXIgTmFtZQog\
ICAgZGVmYXVsdDogJycKICAgIGRpc3BsYXlfZ3JvdXA6IFByb3Zpc2lvbiBEZXRhaWwKICAgIHR5\
cGU6IHN0cmluZwogICAgcmVxdWlyZWQ6IHRydWUKICAtIG5hbWU6IGhvc3RfZ3JvdXBfbmFtZQog\
ICAgdGl0bGU6IEhvc3QgR3JvdXAgTmFtZQogICAgZGVmYXVsdDogJ0NlbnRPUyA3IHZpYSBLaWNr\
c3RhcnQvUFhFJwogICAgZGlzcGxheV9ncm91cDogUHJvdmlzaW9uIERldGFpbAogICAgdHlwZTog\
c3RyaW5nCiAgICByZXF1aXJlZDogdHJ1ZQoKCiAgICAK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
